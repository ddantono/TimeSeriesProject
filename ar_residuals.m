function e = ar_residuals(x, model)
% Variables:
% -x: χρονοσειρά εισόδου στην οποία αξιολογείται το AR μοντέλο
% -model: struct του AR μοντέλου (πεδία a: συντελεστές, p: τάξη)
% -a: διάνυσμα συντελεστών AR (p x 1)
% -p: τάξη του AR(p) μοντέλου
% -N: πλήθος δειγμάτων της χρονοσειράς
% -e: διάνυσμα υπολοίπων (innovation / prediction error)
% -t: χρονικός δείκτης
% -past: διάνυσμα παρελθοντικών τιμών [x(t−1), … , x(t−p)]

x = x(:);
a = model.a(:);
p = model.p;

N = length(x);
e = NaN(N,1);

% Υπολογισμός υπολοίπων σύμφωνα με τον ορισμό του AR(p):
% x(t) = Σ_{k=1..p} a_k x(t-k) + e(t)
% ⇒ e(t) = x(t) − Σ_{k=1..p} a_k x(t-k)
for t = (p+1):N
    past = x(t-1:-1:t-p);
    e(t) = x(t) - (a' * past);
end

% Τα πρώτα p δείγματα παραμένουν NaN, καθώς δεν υπάρχει επαρκές παρελθόν
% για τον υπολογισμό των υπολοίπων σε αυτά τα σημεία
end
